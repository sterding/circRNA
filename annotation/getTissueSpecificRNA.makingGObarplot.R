setwd("~/projects/circRNA/data/")
## 

## SNDA
txt="Category	Term	Count	%	PValue	Genes	List Total	Pop Hits	Pop Total	Fold Enrichment	Bonferroni	Benjamini	FDR
KEGG_PATHWAY	hsa04144:Endocytosis	27	2.6600985221674875	3.3291826146120042E-6	PRKCZ, ARFGAP3, USP8, ERBB4, CHMP5, ADRBK2, PIP5K1C, EEA1, AP2B1, SMAP1, DNAJC6, ITCH, NEDD4L, AGAP1, VPS36, AP2M1, DNM3, PLD1, FLT1, PSD3, EPS15, RAB11FIP5, RAB5A, SMURF2, PDCD6IP, ARAP1, EPN2	271	184	5085	2.753389218674795	4.7928819920872723E-4	4.7928819920872723E-4	0.00394743514806617
KEGG_PATHWAY	hsa04360:Axon guidance	20	1.9704433497536946	4.093762334730165E-5	DCC, ABLIM1, ABLIM2, PLXNC1, GNAI3, ARHGEF12, EPHA3, EPHA5, PTK2, EPHA7, EPHA6, ROBO1, PAK3, RAC1, SEMA3D, SRGAP3, PPP3CC, UNC5C, PAK1, NFATC3	271	129	5085	2.9091221144769586	0.00587779619579154	0.0029432293975391044	0.04853011797962825
KEGG_PATHWAY	hsa04520:Adherens junction	12	1.1822660098522169	0.0022509180072002363	TJP1, PTPRM, CSNK2A1, EP300, SORBS1, RAC1, FER, INSR, MLLT4, CTNNA3, VCL, CTNNA2	271	77	5085	2.924234437149566	0.2771095132300332	0.10252125943443868	2.636604115803809
KEGG_PATHWAY	hsa05120:Epithelial cell signaling in Helicobacter pylori infection	11	1.083743842364532	0.00284286742905694	TJP1, ADAM10, PTPRZ1, MAP2K4, RAC1, ADAM17, ATP6V1H, ATP6V0A1, MAPK10, PAK1, ATP6V0A2	271	68	5085	3.03532667679618	0.33632048983020024	0.09741190184795778	3.319329326825937
KEGG_PATHWAY	hsa04012:ErbB signaling pathway	12	1.1822660098522169	0.00589684007748846	PTK2, ERBB4, BRAF, PAK3, MAP2K4, MAPK10, MTOR, PAK1, NRG1, SHC3, AKT3, PIK3R1	271	87	5085	2.588115536327777	0.5732933453548004	0.15661497948680492	6.772503279666209
KEGG_PATHWAY	hsa04530:Tight junction	15	1.477832512315271	0.011077830921020687	PRKCZ, MAGI2, GNAI3, EPB41, MAGI1, CNKSR3, CTNNA3, CTNNA2, EPB41L2, TJP1, CSNK2A1, EXOC4, PPP2R2C, MLLT4, AKT3, PPP2R2A	271	134	5085	2.100429586385416	0.7989314076576125	0.23459603748326052	12.373433412014966
KEGG_PATHWAY	hsa04120:Ubiquitin mediated proteolysis	14	1.3793103448275863	0.029067178905540607	BTRC, UBE4B, BIRC6, HERC4, HERC3, HERC1, RBX1, RFWD2, PIAS4, UBA2, SMURF2, PIAS2, NEDD4L, ITCH	271	137	5085	1.9174724593961268	0.9857030887885906	0.45491632626880363	29.51471026960215
KEGG_PATHWAY	hsa04722:Neurotrophin signaling pathway	13	1.2807881773399015	0.030851072341773922	PDK1, BRAF, MAPK10, RPS6KA5, MAP3K5, PSEN1, RAC1, NTRK2, SORT1, SHC3, PIK3R1, AKT3, MAP2K5	271	124	5085	1.967176526603976	0.9890292879431406	0.43110862158072316	31.035034926867255
KEGG_PATHWAY	hsa05211:Renal cell carcinoma	9	0.8866995073891626	0.030867947134760633	EP300, BRAF, PAK3, ARNT2, RAC1, PAK1, AKT3, PIK3R1, RBX1	271	70	5085	2.412493410648392	0.9890567608538327	0.39448163282624404	31.049271997477202
KEGG_PATHWAY	hsa04930:Type II diabetes mellitus	7	0.6896551724137931	0.03649475332429082	PRKCZ, MAPK10, MTOR, CACNA1D, INSR, PIK3R1, CACNA1B	271	47	5085	2.7946141163539298	0.9952686172451486	0.4145378702372179	35.649299055880704
KEGG_PATHWAY	hsa04330:Notch signaling pathway	7	0.6896551724137931	0.03649475332429082	EP300, KAT2B, PSEN1, MAML1, ADAM17, RBPJ, NCOR2	271	47	5085	2.7946141163539298	0.9952686172451486	0.4145378702372179	35.649299055880704
KEGG_PATHWAY	hsa04070:Phosphatidylinositol signaling system	9	0.8866995073891626	0.04115039378972568	PLCE1, PIK3C3, PI4KA, PIP5K1C, DGKH, INPP4B, DGKI, PLCB1, PIK3R1	271	74	5085	2.282088361424155	0.9976445647595944	0.4231041976255012	39.241027503659176
KEGG_PATHWAY	hsa04010:MAPK signaling pathway	22	2.167487684729064	0.04387704499493134	BRAF, NF1, MAP2K4, MAPK10, CACNA2D3, FLNB, ATF2, MAP4K3, RPS6KA5, TNFRSF1A, MAP3K5, RASGRP3, MAPT, NTRK2, RAC1, PPP3CC, PAK1, CACNA1D, MAP3K13, AKT3, MAP2K5, CACNA1B	271	267	5085	1.5460840001658442	0.9984369269095982	0.4163332672510949	41.25837801982337"
kegg=read.delim(text = txt, stringsAsFactors = F) %>% arrange(-PValue)
kegg$Term <- sub("hsa\\d+:(.*)","\\1",kegg$Term)
kegg$Term <- factor(kegg$Term, as.character(kegg$Term))

pdf("../results/Merge_circexplorer_BC109.cellspecific_heatmap5.genes3.SNDA.KEGG.pdf", width=9, height=nrow(kegg)/5)
p = ggplot(kegg, aes(x = Term, y = -log10(PValue))) + 
  geom_bar(stat = "identity") + 
  coord_flip() + 
  theme_bw() + theme_classic() +
  xlab("KEGG pathway") + ylab("-log10(EASE p value)") 
print(p)
dev.off() 

# NN
txt="Category	Term	Count	%	PValue	Genes	List Total	Pop Hits	Pop Total	Fold Enrichment	Bonferroni	Benjamini	FDR
KEGG_PATHWAY	hsa04120:Ubiquitin mediated proteolysis	43	2.126607319485658	5.166893950682375E-10	UBE2Z, UBE2G1, PPIL2, SAE1, UBE3C, UBE2R2, FANCL, CUL2, FBXW7, CUL5, FBXW8, UBE2D2, MAP3K1, FBXO4, ITCH, TRIP12, ANAPC1, DDB1, CBL, ANAPC4, UBE4B, BIRC6, HERC4, UBE2F, MID1, HERC1, UBE2Q2, UBE2C, CDC27, TRIM37, RFWD2, CBLB, HUWE1, CUL4A, UBE2K, UBA2, UBR5, MDM2, PIAS2, SMURF2, ANAPC7, SMURF1, PIAS1	578	137	5085	2.7612835602252925	8.83538763263303E-8	8.83538763263303E-8	6.30976515481052E-7
KEGG_PATHWAY	hsa03018:RNA degradation	25	1.2363996043521266	2.623541047320981E-9	CNOT8, CNOT3, CNOT2, CNOT1, SKIV2L2, CNOT6, CNOT4, EXOSC10, PATL1, PARN, CNOT6L, ENO3, RQCD1, ZCCHC7, HSPA9, CNOT10, DDX6, DIS3, PAPOLA, DCP2, DCP1B, DCP1A, MPHOSPH6, XRN1, XRN2	578	57	5085	3.858586778364596	4.486254197022532E-7	2.2431273505318927E-7	3.2038453112726017E-6
KEGG_PATHWAY	hsa04144:Endocytosis	44	2.1760633036597428	1.912889151772392E-6	PARD3, USP8, LDLR, TSG101, CHMP5, ASAP2, ADRBK2, PIP5K1C, ASAP1, EEA1, PIP5K1A, CDC42, IGF1R, DAB2, SH3GLB1, PIKFYVE, GIT2, STAM, ITCH, EGF, VPS36, DNM3, PLD1, DNM1L, MET, CBL, TGFBR2, PSD3, RUFY1, HLA-E, EPS15, CBLB, RAB11FIP3, RABEP1, TFRC, SH3KBP1, RAB5A, MDM2, SMURF2, SMURF1, ARAP2, RAB11FIP1, PIP4K2B, DNM2	578	184	5085	2.103768617421393	3.2705086500794955E-4	1.0902884185903794E-4	0.0023359784289800345
KEGG_PATHWAY	hsa04666:Fc gamma R-mediated phagocytosis	28	1.3847675568743818	3.58217892378817E-6	ASAP2, NCF1C, ASAP1, PIP5K1C, RPS6KB1, PIP5K1A, AMPH, CDC42, GAB2, PIKFYVE, PAK1, PIK3R3, PIK3R1, AKT3, AKT2, DNM3, PTPRC, PLD1, DNM1L, VAV3, LYN, PRKCB, ARPC1A, MAPK1, MYO10, PLCG2, DNM2, PIP4K2B	578	95	5085	2.5929703150610086	6.123661204006092E-4	1.531266981883439E-4	0.004374437683096755
KEGG_PATHWAY	hsa04012:ErbB signaling pathway	25	1.2363996043521266	2.1688148683645927E-5	NRG4, BRAF, ERBB2, MAP2K4, CBL, RPS6KB1, PRKCB, MAPK1, NCK2, PTK2, CBLB, PAK2, GSK3B, SOS2, PLCG2, CAMK2D, MAPK9, MAPK8, PAK1, PIK3R3, EGF, NRG1, AKT3, PIK3R1, AKT2	578	87	5085	2.5280396134112872	0.0037018448582480934	7.41467705388188E-4	0.026482157299800857
KEGG_PATHWAY	hsa04660:T cell receptor signaling pathway	28	1.3847675568743818	4.666905835912459E-5	NFKBIE, NFKB1, CDC42, PAK2, RASGRP1, SOS2, NFAT5, PPP3CB, PPP3CC, PAK1, PPP3CA, NFATC2, PIK3R3, NFATC3, PIK3R1, AKT3, AKT2, DLG1, PDK1, PTPRC, VAV3, CBL, MAPK1, NCK2, CBLB, FYN, GSK3B, MAPK9	578	108	5085	2.2808535178777394	0.007948834799524906	0.0013292150108374923	0.05697693723698549
KEGG_PATHWAY	hsa04520:Adherens junction	22	1.0880316518298714	8.475243824154045E-5	PTPRJ, PARD3, ERBB2, TGFBR2, CREBBP, MET, SMAD4, SMAD3, SMAD2, FER, TCF7L2, IQGAP1, CTNNB1, VCL, CDC42, MAPK1, IGF1R, TJP1, EP300, FYN, PVRL3, YES1	578	77	5085	2.513593672763223	0.014388759084674185	0.002068326789352093	0.10344977525214016
KEGG_PATHWAY	hsa05212:Pancreatic cancer	21	1.0385756676557862	9.42077363117628E-5	PLD1, BRAF, RALBP1, ERBB2, ARHGEF6, TGFBR2, SMAD4, SMAD3, SMAD2, NFKB1, CDC42, MAPK1, VEGFC, RALB, MAPK9, MAPK8, EGF, PIK3R3, PIK3R1, AKT3, AKT2	578	72	5085	2.565960207612457	0.0159812052708721	0.0020117589171753103	0.11498492357034928
KEGG_PATHWAY	hsa05200:Pathways in cancer	59	2.917903066271019	2.7930242084752603E-4	ARNT2, FOXO1, NFKB1, CTNNB1, CDC42, CUL2, RALB, TPR, AKT3, CSF2RA, AKT2, PLD1, BRAF, RALBP1, RUNX1T1, STK4, DAPK1, PRKCB, MAPK1, VEGFC, HIF1A, EP300, NCOA4, MDM2, MAPK9, PIAS2, MAPK8, PIAS1, ERBB2, TFG, TCF7L2, ITGB1, TPM3, IGF1R, PTK2, SOS2, PIK3R3, RUNX1, LAMB1, EGF, TRAF5, PIK3R1, AXIN1, APC, FN1, MSH3, MSH2, FLT3, CBL, MET, CREBBP, TGFBR2, SMAD4, SMAD3, SMAD2, CBLB, ETS1, GSK3B, PLCG2	578	328	5085	1.5824911384926998	0.0466444739640709	0.005293427402402351	0.34054812657710043
KEGG_PATHWAY	hsa05210:Colorectal cancer	22	1.0880316518298714	3.2196245027239307E-4	MSH3, BRAF, MSH2, MET, TGFBR2, SMAD4, SMAD3, SMAD2, TCF7L2, CTNNB1, MAPK1, IGF1R, GSK3B, SOS2, MAPK9, MAPK8, PIK3R3, PIK3R1, AKT3, AXIN1, APC, AKT2	578	84	5085	2.304127533366288	0.05357584519395597	0.005491311705019486	0.39246885232204765
KEGG_PATHWAY	hsa05213:Endometrial cancer	16	0.791295746785361	4.49274597936613E-4	BRAF, ERBB2, FOXO3, TCF7L2, CTNNB1, MAPK1, PDPK1, GSK3B, SOS2, PIK3R3, EGF, PIK3R1, AKT3, AKT2, APC, AXIN1	578	52	5085	2.7069470322065476	0.07396497344062469	0.006961403604568095	0.5472704774260984
KEGG_PATHWAY	hsa04662:B cell receptor signaling pathway	20	0.9891196834817012	5.136718795272768E-4	VAV3, LYN, NFKBIE, NFKB1, PRKCB, MAPK1, RASGRP3, GSK3B, SOS2, PLCG2, NFAT5, PPP3CB, PPP3CC, PPP3CA, NFATC2, PIK3R3, NFATC3, PIK3R1, AKT3, AKT2	578	75	5085	2.346020761245675	0.08411132822253564	0.0072949665364338	0.6254883925679189
KEGG_PATHWAY	hsa05211:Renal cell carcinoma	19	0.9396636993076163	5.907197192890519E-4	BRAF, ARNT2, MET, CREBBP, PTPN11, CDC42, MAPK1, CUL2, VEGFC, EP300, HIF1A, PAK2, ETS1, SOS2, PAK1, PIK3R3, PIK3R1, AKT3, AKT2	578	70	5085	2.3879139891250616	0.0961057621471969	0.007742404206606324	0.7189976538193199
KEGG_PATHWAY	hsa04070:Phosphatidylinositol signaling system	19	0.9396636993076163	0.0011978860068435843	PIK3C2A, SYNJ1, PIP5K1C, DGKH, PIP5K1A, ITPR2, PRKCB, PLCE1, DGKE, DGKD, DGKG, PIK3C3, PIKFYVE, PLCG2, INPP4B, PIP4K2A, PIK3R3, PIK3R1, PIP4K2B	578	74	5085	2.2588375572804638	0.18532114946773437	0.01453344718796612	1.453064388684966
KEGG_PATHWAY	hsa04722:Neurotrophin signaling pathway	27	1.3353115727002967	0.0012482474437686196	NFKBIE, NFKB1, FOXO3, MAGED1, CDC42, IRAK3, MAP3K5, MAP3K1, SOS2, CAMK2D, PIK3R3, PIK3R1, AKT3, AKT2, PDK1, BRAF, YWHAE, PTPN11, RPS6KA5, MAPK1, CAMK4, PSEN1, GSK3B, PLCG2, MAPK9, SORT1, MAPK8	578	124	5085	1.915601629646166	0.192315400041856	0.014138015717977237	1.513727224739747
KEGG_PATHWAY	hsa04350:TGF-beta signaling pathway	21	1.0385756676557862	0.0013910114214953054	PPP2R1B, LTBP1, RBL2, ROCK1, ROCK2, RBL1, SMAD5, CREBBP, TGFBR2, BMPR2, SMAD4, SMAD3, SMAD2, RPS6KB1, MAPK1, EP300, ID2, ROCK1P1, PPP2CA, SMURF2, SMURF1, THBS1	578	87	5085	2.1235532752654818	0.21181980522430743	0.014766671223738426	1.6855071800976007
KEGG_PATHWAY	hsa04150:mTOR signaling pathway	15	0.741839762611276	0.0014611449328108452	BRAF, RPS6KB1, RICTOR, RPTOR, MAPK1, VEGFC, PDPK1, HIF1A, TSC1, PRKAA1, CAB39, PIK3R3, PIK3R1, AKT3, AKT2	578	52	5085	2.5377628426936383	0.22122919961395116	0.01460051057864542	1.7697941334431255
KEGG_PATHWAY	hsa05215:Prostate cancer	21	1.0385756676557862	0.0018671537909483926	BRAF, CREB1, ERBB2, CREBBP, FOXO1, CREB5, NFKB1, TCF7L2, CTNNB1, MAPK1, IGF1R, PDPK1, EP300, GSK3B, SOS2, MDM2, EGF, PIK3R3, PIK3R1, AKT3, AKT2	578	89	5085	2.0758329769449086	0.27354718416778445	0.01759785818618309	2.2564361323063054
KEGG_PATHWAY	hsa04360:Axon guidance	27	1.3353115727002967	0.0022655016929006835	PLXNC1, GNAI3, GNAI1, ITGB1, CDC42, PTK2, UNC5B, PAK2, NFAT5, SEMA3D, PPP3CB, PPP3CC, PAK1, PPP3CA, NFATC2, NFATC3, RASA1, ROCK1, ROCK2, MET, NTNG1, ARHGEF12, NCK2, MAPK1, ROCK1P1, FYN, GSK3B, SRGAP1	578	129	5085	1.841353504466082	0.3214792933954872	0.020205718724664368	2.7317435856601957
KEGG_PATHWAY	hsa04510:Focal adhesion	37	1.8298714144411472	0.0032329924097519616	TLN2, ERBB2, ITGA11, PIP5K1C, ITGB1, VCL, CTNNB1, CDC42, IGF1R, PTK2, PDPK1, DOCK1, PAK2, SOS2, PAK1, LAMB1, THBS1, EGF, PIK3R3, AKT3, PIK3R1, AKT2, FN1, VAV3, ROCK1, BRAF, ROCK2, MET, CAPN2, PRKCB, MAPK1, VEGFC, FYN, ROCK1P1, GSK3B, MAPK9, MAPK8, COL1A1	578	201	5085	1.6194546299643648	0.4252023995727914	0.027307096660696195	3.8773281972043216
KEGG_PATHWAY	hsa04310:Wnt signaling pathway	29	1.434223541048467	0.005473605725093728	PPP2R5C, DAAM1, TCF7L2, CTNNB1, PPP2CA, NFAT5, PPP3CB, CAMK2D, PPP3CC, PPP3CA, NFATC2, NFATC3, AXIN1, APC, PPP2R1B, TBL1XR1, ROCK1, ROCK2, CREBBP, SMAD4, SMAD3, SMAD2, PRKCB, SENP2, EP300, PSEN1, ROCK1P1, GSK3B, MAPK9, MAPK8	578	151	5085	1.6896010449368684	0.6088083070276048	0.043709190254792474	6.482986219869202
KEGG_PATHWAY	hsa04810:Regulation of actin cytoskeleton	38	1.8793273986152326	0.0056814587184811	ITGAL, ENAH, DIAPH2, DIAPH3, SSH2, ITGA11, PIP5K1C, ABI2, IQGAP2, PIP5K1A, ITGB1, IQGAP1, VCL, CDC42, PTK2, DOCK1, PAK2, TIAM2, SOS2, PIKFYVE, PAK1, PIK3R3, EGF, PIK3R1, APC, FN1, VAV3, ROCK1, BRAF, ROCK2, ARHGEF6, ARHGEF12, NCKAP1, ARPC1A, MAPK1, ROCK1P1, CYFIP2, PIP4K2A, PIP4K2B	578	215	5085	1.5549207371046914	0.622543440518788	0.043320031026182204	6.721385815027736
KEGG_PATHWAY	hsa04010:MAPK signaling pathway	45	2.225519287833828	0.006104337556493562	MAPKAPK5, PPM1A, NFKB1, PPM1B, ATF2, CDC42, MAP3K5, MAP3K4, RASGRP3, PAK2, ELK4, RASGRP1, MAP3K1, SOS2, DUSP16, PPP3CB, PPP3CC, PPP3CA, PAK1, RAPGEF2, EGF, NFATC2, RASA1, AKT3, RASA2, AKT2, BRAF, TAOK1, NF1, TAOK3, MAP2K4, TGFBR2, STK4, TAB2, STK3, PRKCB, MAP4K3, RPS6KA5, MAPK1, MAP4K4, RASGRF2, DUSP1, MAPK9, MAPK8, CACNA1D	578	267	5085	1.482737840674935	0.6490251563021406	0.044502861365909085	7.204690502037325
KEGG_PATHWAY	hsa05223:Non-small cell lung cancer	14	0.6923837784371909	0.006124314704570459	MAPK1, PDPK1, BRAF, ERBB2, SOS2, PLCG2, FOXO3, PIK3R3, EGF, STK4, AKT3, PIK3R1, PRKCB, AKT2	578	54	5085	2.2808535178777394	0.6502294239326689	0.042825831513365165	7.227465243936182
KEGG_PATHWAY	hsa05120:Epithelial cell signaling in Helicobacter pylori infection	16	0.791295746785361	0.007967451972101938	ADAM10, LYN, MET, MAP2K4, NFKB1, PTPN11, CDC42, ATP6V1A, TJP1, ATP6V1E1, PLCG2, MAPK9, ADAM17, MAPK8, PAK1, ATP6V0A2	578	68	5085	2.070018318746184	0.7453565263592874	0.05324566575784895	9.306772853098854
KEGG_PATHWAY	hsa05220:Chronic myeloid leukemia	17	0.8407517309594461	0.008710257663359016	BRAF, CBL, TGFBR2, SMAD4, SMAD3, NFKB1, PTPN11, MAPK1, CBLB, GAB2, SOS2, MDM2, RUNX1, PIK3R3, PIK3R1, AKT3, AKT2	578	75	5085	1.9941176470588236	0.7759707690093488	0.05591364932917475	10.13259337913709
KEGG_PATHWAY	hsa03450:Non-homologous end-joining	6	0.2967359050445104	0.010930863579773298	XRCC5, XRCC4, MRE11A, XRCC6, PRKDC, RAD50	578	13	5085	4.060420548309821	0.8473287857602279	0.0672424270963563	12.560378595766652
KEGG_PATHWAY	hsa04110:Cell cycle	24	1.1869436201780417	0.012308580888481465	ANAPC1, RBL2, CDC14A, DBF4, RBL1, CREBBP, ANAPC4, SMAD4, SMAD3, PRKDC, SMAD2, ATR, MCM3, CDC27, YWHAE, ATM, CCNB1, EP300, GSK3B, BUB1B, MDM2, ANAPC7, STAG2, STAG1	578	125	5085	1.6891349480968856	0.8797073751214508	0.0728470319932707	14.036210682552387
KEGG_PATHWAY	hsa03022:Basal transcription factors	10	0.4945598417408506	0.013737324772909074	STON1-GTF2A1L, TAF2, GTF2E1, TAF1, TAF12, GTF2H2C, GTF2A1, TAF5, TAF4B, GTF2B, GTF2H2, GTF2H2B	578	35	5085	2.513593672763223	0.9060851631881545	0.07832662553375647	15.54251799224432
KEGG_PATHWAY	hsa04914:Progesterone-mediated oocyte maturation	18	0.8902077151335311	0.014934109331099087	ANAPC1, GNAI3, BRAF, GNAI1, ANAPC4, PDE3B, PDE3A, CDC27, CCNB1, MAPK1, IGF1R, MAPK9, MAPK8, ANAPC7, PIK3R3, PIK3R1, AKT3, AKT2	578	86	5085	1.8413535044660818	0.9236932257630813	0.08219144146770663	16.785580673579126
KEGG_PATHWAY	hsa04910:Insulin signaling pathway	25	1.2363996043521266	0.016112123672849313	BRAF, PHKB, PRKAG2, CBL, ACACA, PRKAB1, FOXO1, PDE3B, PDE3A, RPS6KB1, RPTOR, MAPK1, PDPK1, PRKAR2A, CBLB, TSC1, GSK3B, SOS2, MAPK9, MAPK8, PRKAA1, PIK3R3, PIK3R1, AKT3, AKT2	578	135	5085	1.6291810841983851	0.9378130635850309	0.08570347370264664	17.992722070145707
KEGG_PATHWAY	hsa04920:Adipocytokine signaling pathway	15	0.741839762611276	0.016331261163287678	CD36, NFKBIE, PRKAG2, PRKAB1, MAPK9, MAPK8, JAK2, NFKB1, PRKAA1, ACSL4, ACSL3, AKT3, CPT1A, PTPN11, AKT2	578	67	5085	1.9696069823890925	0.9401372435046127	0.08423055882857255	18.21549630873679
KEGG_PATHWAY	hsa00310:Lysine degradation	11	0.5440158259149357	0.022808606597144537	DLST, EHMT1, SETDB2, PLOD2, SETD1B, WHSC1L1, TMLHE, ASH1L, AASS, WHSC1, SETD2	578	44	5085	2.1993944636678204	0.9806572913488167	0.11268815002299937	24.554705324143754
KEGG_PATHWAY	hsa05221:Acute myeloid leukemia	13	0.6429277942631058	0.02706338910381256	MAPK1, BRAF, FLT3, SOS2, RUNX1T1, RPS6KB1, NFKB1, PIK3R3, RUNX1, TCF7L2, AKT3, PIK3R1, AKT2	578	58	5085	1.9718708984608042	0.9908281414916376	0.12889145301268023	28.469787061316687
KEGG_PATHWAY	hsa04664:Fc epsilon RI signaling pathway	16	0.791295746785361	0.027072160794205307	PDK1, VAV3, LYN, MAP2K4, PRKCB, MAPK1, GAB2, FYN, PLCG2, SOS2, MAPK9, MAPK8, PIK3R3, PIK3R1, AKT3, AKT2	578	78	5085	1.8046313548043653	0.9908422707521428	0.12548882060567534	28.477662051073903
KEGG_PATHWAY	hsa00510:N-Glycan biosynthesis	11	0.5440158259149357	0.03050228033923447	STT3B, MAN2A1, MGAT4A, STT3A, MAN1A2, FUT8, DPAGT1, ALG6, MGAT5, ALG8, ALG9	578	46	5085	2.103768617421393	0.9949938781273109	0.13682816382799934	31.496840708924147
KEGG_PATHWAY	hsa04210:Apoptosis	17	0.8407517309594461	0.033557898678779105	CFLAR, DFFB, NFKB1, CAPN2, ATM, IRAK3, PRKAR2A, RIPK1, IL1RAP, PPP3CB, PPP3CC, APAF1, PPP3CA, PIK3R3, PIK3R1, AKT3, AKT2	578	87	5085	1.7190669371196754	0.9970821107588713	0.14594007097607775	34.087365888949925
KEGG_PATHWAY	hsa04330:Notch signaling pathway	11	0.5440158259149357	0.0349667707042315	NOTCH2, EP300, KAT2B, PSEN1, MAML1, DTX3L, MAML2, NUMB, CREBBP, ADAM17, NCOR2	578	47	5085	2.059007583008172	0.9977263281023024	0.1479988026358121	35.25122919321277
KEGG_PATHWAY	hsa05216:Thyroid cancer	8	0.3956478733926805	0.0393852898512478	MAPK1, BRAF, NCOA4, TFG, TPR, TCF7L2, CTNNB1, TPM3	578	29	5085	2.426918028874836	0.9989626655231006	0.16153469271189913	38.780079746703976
KEGG_PATHWAY	hsa04370:VEGF signaling pathway	15	0.741839762611276	0.0402410846496183	PRKCB, CDC42, MAPK1, PTK2, PLCG2, NFAT5, PPP3CB, PPP3CC, PPP3CA, NFATC2, PIK3R3, NFATC3, PIK3R1, AKT3, AKT2	578	75	5085	1.759515570934256	0.9991093060315446	0.16103621798077494	39.442798161581905
KEGG_PATHWAY	hsa04630:Jak-STAT signaling pathway	26	1.2858555885262115	0.04251028046032264	IL6ST, CBL, CREBBP, SOCS7, STAT2, IFNAR1, PTPN11, IL12RB2, STAT6, CBLB, STAT4, EP300, IL4R, SOS2, IL15RA, PIAS2, STAM, JAK2, PIAS1, PIK3R3, IL13RA1, IFNGR2, AKT3, CSF2RA, PIK3R1, AKT2	578	155	5085	1.4757227369126018	0.9994057975095298	0.1657130030055829	41.16828319760095
KEGG_PATHWAY	hsa04730:Long-term depression	14	0.6923837784371909	0.04403369711269925	PPP2R1B, GNAI3, LYN, BRAF, GNAI1, PRKG1, ITPR2, PRKCB, IGF1R, MAPK1, GNAQ, PPP2CA, GUCY1A3, GUCY1B3	578	69	5085	1.78501579659997	0.9995474340650322	0.1675208259846096	42.301230890331844
KEGG_PATHWAY	hsa05214:Glioma	13	0.6429277942631058	0.048146155463313856	MAPK1, IGF1R, BRAF, SOS2, PLCG2, CAMK2D, MDM2, PIK3R3, EGF, AKT3, PIK3R1, PRKCB, AKT2	578	63	5085	1.8153732081067722	0.9997834710901348	0.178174828026887	45.26035280314583"
kegg=read.delim(text = txt, stringsAsFactors = F) %>% arrange(-PValue)
kegg$Term <- sub("hsa\\d+:(.*)","\\1",kegg$Term)
kegg$Term <- factor(kegg$Term, as.character(kegg$Term))

pdf("../results/Merge_circexplorer_BC109.cellspecific_heatmap5.genes3.NN.KEGG.pdf", width=9, height=nrow(kegg)/5)
p = ggplot(kegg, aes(x = Term, y = -log10(PValue))) + 
  geom_bar(stat = "identity") + 
  coord_flip() + 
  theme_bw() + theme_classic() +
  xlab("KEGG pathway") + ylab("-log10(EASE p value)") 
print(p)
dev.off() 

# PY
txt="Category	Term	Count	%	PValue	Genes	List Total	Pop Hits	Pop Total	Fold Enrichment	Bonferroni	Benjamini	FDR
KEGG_PATHWAY	hsa04012:ErbB signaling pathway	28	1.6646848989298455	5.730642978015964E-9	ERBB4, ERBB2, CAMK2G, STAT5B, RPS6KB1, PAK7, PTK2, PAK2, PAK3, SOS1, CAMK2D, PAK1, NRG1, PIK3R3, SHC3, AKT3, PRKCA, BRAF, PIK3CB, MAP2K4, RAF1, MAPK10, PRKCB, MAPK1, GSK3B, MAPK9, MTOR, ABL2	467	87	5085	3.504393413571587	9.283637312229587E-7	9.283637312229587E-7	6.9343632835838775E-6
KEGG_PATHWAY	hsa04720:Long-term potentiation	21	1.2485136741973841	1.4769706240100593E-6	PRKCA, BRAF, CAMK2G, GRIN1, CREBBP, GRIN2A, RAF1, ITPR2, PRKCB, GRM5, MAPK1, EP300, CAMK4, GRIN2B, RPS6KA2, CAMK2D, PPP3CC, PPP3CA, PRKACB, PLCB1, CACNA1C	467	68	5085	3.3626716211109713	2.392407951449238E-4	1.1962755294814276E-4	0.0017871933925328598
KEGG_PATHWAY	hsa04360:Axon guidance	27	1.6052318668252081	8.140204573314522E-5	DCC, ABLIM1, ABLIM2, GNAI1, PLXNA2, LRRC4C, PAK7, PTK2, UNC5B, PAK2, PAK3, ROBO1, NFAT5, SEMA3D, PPP3CC, ROBO2, PAK1, PPP3CA, NFATC3, ROCK2, ARHGEF12, SLIT2, EPHA3, EPHA5, MAPK1, GSK3B, SRGAP1	467	129	5085	2.2790199691250437	0.01310109186949504	0.0043862416094855305	0.09845604058114077
KEGG_PATHWAY	hsa04010:MAPK signaling pathway	44	2.6159334126040426	1.376680791291714E-4	MEF2C, CACNB2, CACNB4, ATF2, MAP3K4, RASGRP3, PAK2, MAP3K2, RASGRP1, MAPT, SOS1, PPP3CC, PPP3CA, PRKACB, PAK1, AKT3, HSPA8, MAP2K5, PRKCA, CACNA2D1, BRAF, TAOK1, NLK, NF1, TAOK3, MAP2K4, PTPRR, RAF1, MAPK10, CACNA2D3, STK3, PRKCB, MAP4K3, MAPK1, MAP4K4, RASGRF2, RPS6KA2, ARRB1, NTRK2, MAPK9, CACNA1E, CACNA1C, MAP3K13, CACNA1A	467	267	5085	1.7943844284580035	0.022056874097610035	0.005560424322384572	0.16645800738980254
KEGG_PATHWAY	hsa04520:Adherens junction	19	1.1296076099881094	1.4673778153617727E-4	PTPRJ, PARD3, PTPRM, ACTN4, NLK, ERBB2, CREBBP, LEF1, FER, TCF7L2, IQGAP1, CTNNA2, VCL, FARP2, MAPK1, TJP1, EP300, SORBS1, MLLT4	467	77	5085	2.686809978030535	0.023492906877630948	0.00474336750471549	0.17741548766312398
KEGG_PATHWAY	hsa05211:Renal cell carcinoma	17	1.0107015457788349	4.4669973111088017E-4	BRAF, PIK3CB, ARNT2, CREBBP, RAF1, EGLN1, MAPK1, PAK7, EP300, HIF1A, PAK2, PAK3, SOS1, PAK1, PIK3R3, RAPGEF1, AKT3	467	70	5085	2.644386662587947	0.06982405638676936	0.011991113993734759	0.539190813772028
KEGG_PATHWAY	hsa04020:Calcium signaling pathway	31	1.8430439952437574	5.466433162890877E-4	ERBB4, PHKB, ERBB2, CAMK2G, ATP2B1, ATP2B4, PDE1C, PDE1A, CAMK2D, PPP3CC, PPP3CA, PRKACB, PLCB1, PRKCA, TRPC1, SLC8A1, NOS1, GRIN1, GRIN2A, VDAC3, ITPR2, PRKCB, GRM5, CAMK4, PPID, RYR3, RYR2, GNAS, CACNA1E, CACNA1C, CACNA1A	467	176	5085	1.9178873856336385	0.0847705044945628	0.012574617610792926	0.6594624463707177
KEGG_PATHWAY	hsa04070:Phosphatidylinositol signaling system	17	1.0107015457788349	8.586987465724692E-4	PRKCA, PIK3CB, PIK3C2A, SYNJ1, PIP5K1B, DGKH, PIP5K1A, PI4KB, DGKI, ITPR2, PRKCB, DGKB, DGKG, PIK3C3, PIKFYVE, PLCB1, PIK3R3	467	74	5085	2.501446842988599	0.12991899076458657	0.01724568082432154	1.0341303652090517
KEGG_PATHWAY	hsa04540:Gap junction	19	1.1296076099881094	9.633686615404524E-4	PRKCA, GNAI1, RAF1, LPAR1, PRKG2, PRKG1, ITPR2, PRKCB, GRM5, MAPK1, TJP1, MAP3K2, SOS1, GUCY1A2, GUCY1A3, GNAS, PRKACB, PLCB1, MAP2K5	467	89	5085	2.3245434641387774	0.14456138868988522	0.017199366736145083	1.1595111995961194
KEGG_PATHWAY	hsa04144:Endocytosis	31	1.8430439952437574	0.0011620436273344365	PRKCZ, PARD3, ERBB4, LDLR, TSG101, STAM2, PIP5K1B, ADRBK2, ASAP1, PIP5K1A, SMAP1, SH3GLB1, PIKFYVE, GIT2, VPS4B, DNAJC6, ITCH, NEDD4L, IQSEC3, AGAP1, HSPA8, SH3GL3, DNM3, RUFY1, TFRC, RABEP1, ARRB1, SH3KBP1, GRK4, SMURF2, SMURF1	467	184	5085	1.8345009775626104	0.17168397972423544	0.018659763197775514	1.3970970495247648
KEGG_PATHWAY	hsa04730:Long-term depression	16	0.9512485136741973	0.0011664613247328172	PRKCA, NOS1, BRAF, GNAI1, RAF1, PRKG2, PRKG1, ITPR2, PRKCB, GRM5, MAPK1, GUCY1A2, GUCY1A3, GNAS, PLCB1, CACNA1A	467	69	5085	2.5249045712689697	0.1722772565520978	0.017041936065531837	1.4023740024495357
KEGG_PATHWAY	hsa00310:Lysine degradation	12	0.713436385255648	0.001594226613337507	EHMT1, SETDB2, PLOD2, WHSC1L1, ASH1L, SETD7, WHSC1, SETD2, NSD1, ACAT1, SUV420H1, SUV39H2	467	44	5085	2.9696320809811176	0.22776841753785781	0.021308920324952796	1.91211561532878
KEGG_PATHWAY	hsa04722:Neurotrophin signaling pathway	23	1.3674197384066586	0.0017359950191990956	PDK1, BRAF, PIK3CB, CAMK2G, RAF1, MAPK10, YWHAE, NTRK3, MAPK1, PSEN1, CAMK4, RPS6KA2, GSK3B, SOS1, NTRK2, CAMK2D, MAPK9, SORT1, SHC3, PIK3R3, RAPGEF1, AKT3, MAP2K5	467	124	5085	2.0196691303446848	0.245330658518358	0.02141924678867413	2.0805181992642807
KEGG_PATHWAY	hsa05213:Endometrial cancer	13	0.7728894173602854	0.002085546283217534	BRAF, PIK3CB, ERBB2, RAF1, LEF1, TCF7L2, CTNNA2, MAPK1, GSK3B, SOS1, PIK3R3, AKT3, APC	467	52	5085	2.7221627408993574	0.2869553931015405	0.023868482270622993	2.4946074537556595
KEGG_PATHWAY	hsa04310:Wnt signaling pathway	26	1.5457788347205708	0.0023677729227845096	BTRC, CAMK2G, TCF7L2, CHD8, NFAT5, CAMK2D, PPP3CC, PRKACB, PPP3CA, PLCB1, NFATC3, CUL1, APC, PRKCA, CTBP2, ROCK2, NLK, CREBBP, LEF1, MAPK10, PRKCB, SENP2, EP300, PSEN1, GSK3B, MAPK9	467	151	5085	1.874867053334657	0.31889176211079473	0.025277310750278614	2.8277690857472115
KEGG_PATHWAY	hsa04530:Tight junction	23	1.3674197384066586	0.004699909564377573	PRKCA, PRKCZ, PARD3, INADL, MAGI2, ACTN4, MAGI1, EPB41, GNAI1, CASK, PRKCE, CTNNA2, PRKCB, EPB41L3, TJP1, EPB41L1, ASH1L, EXOC4, PPP2R2B, MLLT4, AKT3, MYH10, SPTAN1	467	134	5085	1.8689475534532902	0.5338184817344354	0.04657904982637329	5.541094876160068
KEGG_PATHWAY	hsa05221:Acute myeloid leukemia	13	0.7728894173602854	0.005436106752546814	MAPK1, BRAF, PIK3CB, SOS1, STAT5B, RUNX1T1, RAF1, LEF1, RPS6KB1, MTOR, PIK3R3, TCF7L2, AKT3	467	58	5085	2.440559698737355	0.5864809336822416	0.05061817342416275	6.38307940445787
KEGG_PATHWAY	hsa04270:Vascular smooth muscle contraction	20	1.1890606420927468	0.005820185384739866	PRKCA, KCNMA1, BRAF, ROCK2, PPP1R12B, CALD1, RAF1, PRKG1, ARHGEF12, PRKCE, ITPR2, PRKCB, MAPK1, GUCY1A2, GUCY1A3, GNAS, CALCRL, PRKACB, PLCB1, CACNA1C	467	112	5085	1.9444019577852554	0.6115631088238204	0.05117860175422673	6.819609725764586
KEGG_PATHWAY	hsa04120:Ubiquitin mediated proteolysis	23	1.3674197384066586	0.006155194672485834	ANAPC1, BTRC, UBE4B, BIRC6, HERC4, UBA6, SAE1, UBE3C, UBE2Q2, HERC1, CDC27, RFWD2, TRIM37, CUL5, UBR5, SMURF2, PIAS1, NEDD4L, ITCH, SMURF1, UBE2E2, CUL1, TRIP12	467	137	5085	1.8280216946185466	0.6322025824609605	0.051281654417595024	7.198844015048711
KEGG_PATHWAY	hsa04916:Melanogenesis	18	1.070154577883472	0.007833341910714456	PRKCA, GNAI1, CAMK2G, CREBBP, LEF1, RAF1, KITLG, TCF7L2, PRKCB, DCT, MAPK1, EP300, GSK3B, CREB3L2, CAMK2D, GNAS, PRKACB, PLCB1	467	99	5085	1.9797547206540782	0.720288834414404	0.06171345165319275	9.07730454716351
KEGG_PATHWAY	hsa04660:T cell receptor signaling pathway	19	1.1296076099881094	0.008628101329389817	PDK1, PIK3CB, RAF1, MAPK1, PAK7, PAK2, PAK3, GSK3B, SOS1, RASGRP1, NFAT5, MAPK9, PPP3CC, PPP3CA, PAK1, PIK3R3, NFATC3, AKT3, DLG1	467	108	5085	1.9155960028551036	0.7543425764826088	0.06466305245078596	9.95470262589524
KEGG_PATHWAY	hsa04930:Type II diabetes mellitus	11	0.6539833531510106	0.008815362749534228	MAPK1, PRKCZ, PIK3CB, MAPK9, CACNA1E, MAPK10, MTOR, PIK3R3, CACNA1C, PRKCE, CACNA1A	467	47	5085	2.548407672331314	0.7617466235206447	0.06312080712539814	10.160301502476376
KEGG_PATHWAY	hsa05214:Glioma	13	0.7728894173602854	0.0106939694479169	PRKCA, MAPK1, BRAF, PIK3CB, CAMK2G, SOS1, CAMK2D, RAF1, MTOR, PIK3R3, SHC3, AKT3, PRKCB	467	63	5085	2.2468644845518506	0.8247869934492909	0.07293202246612174	12.199171015052546
KEGG_PATHWAY	hsa04666:Fc gamma R-mediated phagocytosis	17	1.0107015457788349	0.011686618171553177	PRKCA, DNM3, PIK3CB, PIP5K1B, ASAP1, RAF1, RPS6KB1, PIP5K1A, PRKCE, AMPH, PRKCB, MAPK1, PIKFYVE, PAK1, PPAP2A, PIK3R3, AKT3	467	95	5085	1.9484954355911188	0.8510853323835541	0.07628273390149587	13.25927789228275
KEGG_PATHWAY	hsa05216:Thyroid cancer	8	0.47562425683709864	0.01362859118171146	MAPK1, CCDC6, BRAF, PPARG, TFG, LEF1, TPR, TCF7L2	467	29	5085	3.00376578306136	0.8917178215182044	0.08508177365840563	15.29934265313212
KEGG_PATHWAY	hsa05215:Prostate cancer	16	0.9512485136741973	0.014292007812569464	BRAF, PIK3CB, ERBB2, CREBBP, LEF1, RAF1, CREB5, TCF7L2, MAPK1, EP300, GSK3B, SOS1, CREB3L2, MTOR, PIK3R3, AKT3	467	89	5085	1.9575102855905493	0.9028996013371015	0.08578790638319855	15.986119010376266
KEGG_PATHWAY	hsa04912:GnRH signaling pathway	17	1.0107015457788349	0.015553089998925735	PRKCA, CAMK2G, MAP2K4, RAF1, MAPK10, ITPR2, PRKCB, MAPK1, MAP3K4, MAP3K2, SOS1, CAMK2D, MAPK9, GNAS, PRKACB, PLCB1, CACNA1C	467	98	5085	1.888847616134248	0.9210862606048372	0.08976443400473255	17.277540208865037
KEGG_PATHWAY	hsa05210:Colorectal cancer	15	0.89179548156956	0.019300775366290344	DCC, MSH3, BRAF, PIK3CB, LEF1, RAF1, MAPK10, TCF7L2, MAPK1, GSK3B, SOS1, MAPK9, PIK3R3, AKT3, APC	467	84	5085	1.9444019577852554	0.9574592861189796	0.10663539472676853	21.008683999476517
KEGG_PATHWAY	hsa04910:Insulin signaling pathway	21	1.2485136741973841	0.020477003652610452	PRKCZ, BRAF, PIK3CB, PHKB, PRKAG2, RAF1, RPS6KB1, MAPK10, PPARGC1A, MAPK1, SORBS1, GSK3B, SOS1, RHEB, MAPK9, MTOR, PRKACB, SHC3, PIK3R3, RAPGEF1, AKT3	467	135	5085	1.6937901498929335	0.9649755680719254	0.1091473012186559	22.147489128038643
KEGG_PATHWAY	hsa04350:TGF-beta signaling pathway	15	0.89179548156956	0.02556116380238349	SMAD9, LTBP1, ROCK2, SMAD5, CREBBP, RPS6KB1, MAPK1, EP300, ZFYVE16, ZFYVE9, SMURF2, SMURF1, BMPR1B, CUL1, BMPR1A	467	87	5085	1.87735361441335	0.9849255083747049	0.13048965011572222	26.89873901857619
KEGG_PATHWAY	hsa04810:Regulation of actin cytoskeleton	29	1.7241379310344827	0.03440864876324594	FGD1, ENAH, SSH2, PIP5K1B, ABI2, PIP5K1A, IQGAP1, VCL, PAK7, PTK2, DOCK1, PAK2, TIAM1, PAK3, SOS1, PIKFYVE, PAK1, PIK3R3, APC, ACTN4, BRAF, ROCK2, PIK3CB, ARHGEF7, RAF1, ARHGEF12, NCKAP1, MAPK1, MYH10	467	215	5085	1.4687017578805837	0.9965602610986667	0.16721464369562078	34.53756344652044
KEGG_PATHWAY	hsa04662:B cell receptor signaling pathway	13	0.7728894173602854	0.03856084600905671	MAPK1, RASGRP3, PIK3CB, GSK3B, SOS1, NFAT5, RAF1, PPP3CC, PPP3CA, PIK3R3, NFATC3, AKT3, PRKCB	467	75	5085	1.8873661670235544	0.9982886756431009	0.18051381729266736	37.8637090578906
KEGG_PATHWAY	hsa04150:mTOR signaling pathway	10	0.5945303210463734	0.04439833290042296	MAPK1, HIF1A, BRAF, RPS6KA2, PIK3CB, RHEB, RPS6KB1, MTOR, PIK3R3, AKT3	467	52	5085	2.093971339153352	0.9993619457671702	0.19983877358451374	42.278096045172454
KEGG_PATHWAY	hsa04914:Progesterone-mediated oocyte maturation	14	0.8323424494649228	0.04798049849905836	ANAPC1, MAPK1, BRAF, GNAI1, RPS6KA2, PIK3CB, MAPK9, RAF1, PRKACB, MAPK10, CPEB1, PIK3R3, CDC27, AKT3	467	86	5085	1.772571087097256	0.9996527623215452	0.2088592936865692	44.842562489682294"
kegg=read.delim(text = txt, stringsAsFactors = F) %>% arrange(-PValue)
kegg$Term <- sub("hsa\\d+:(.*)","\\1",kegg$Term)
kegg$Term <- factor(kegg$Term, as.character(kegg$Term))

pdf("../results/Merge_circexplorer_BC109.cellspecific_heatmap5.genes3.PY.KEGG.pdf", width=9, height=nrow(kegg)/5)
p = ggplot(kegg, aes(x = Term, y = -log10(PValue))) + 
  geom_bar(stat = "identity") + 
  coord_flip() + 
  theme_bw() + theme_classic() +
  xlab("KEGG pathway") + ylab("-log10(EASE p value)") 
print(p)
dev.off() 

quit('no')


#### OLD (for BC106) #####
## run DAVID to get the enriched KEGG pathway for the SNDA-specific host genes
txt="Category	Term	Count	%	PValue	Genes	List Total	Pop Hits	Pop Total	Fold Enrichment	Bonferroni	Benjamini	FDR
KEGG_PATHWAY	hsa04721:Synaptic vesicle cycle	8	1.5873015873015872	0.0012399844447873723	SYT1, AP2B1, ATP6V1H, UNC13C, CLTCL1, UNC13B, AP2M1, CACNA1B	182	63	6879	4.799581371009943	0.24264930626033876	0.24264930626033876	1.5715045203099187
KEGG_PATHWAY	hsa05032:Morphine addiction	9	1.7857142857142856	0.0025988720185478507	ADCY2, KCNJ6, GABRB3, ADCY9, PDE10A, PRKCG, GABBR2, PDE8A, CACNA1B	182	91	6879	3.7381354908827436	0.44172583858068404	0.25282253686335265	3.267540392309576
KEGG_PATHWAY	hsa04961:Endocrine and other factor-regulated calcium reabsorption	6	1.1904761904761905	0.006215939205881658	AP2B1, ADCY9, ATP1A3, PRKCG, CLTCL1, AP2M1	182	45	6879	5.039560439560439	0.7525918417745279	0.3722240526486088	7.65163659074013
KEGG_PATHWAY	hsa04727:GABAergic synapse	8	1.5873015873015872	0.00682260021789801	PLCL1, ADCY2, KCNJ6, GABRB3, ADCY9, PRKCG, GABBR2, CACNA1B	182	85	6879	3.557336780866193	0.7842208062099019	0.3184426721502881	8.368752220142351
KEGG_PATHWAY	hsa04713:Circadian entrainment	8	1.5873015873015872	0.012278102794673108	RPS6KA5, ADCY2, KCNJ6, ADCY9, CAMK2G, RYR3, PER2, PRKCG	182	95	6879	3.18288027761712	0.9371697552915499	0.42504513881937067	14.590782790719492
KEGG_PATHWAY	hsa04915:Estrogen signaling pathway	8	1.5873015873015872	0.015161915605377912	ADCY2, KCNJ6, ADCY9, ATF6B, GABBR2, SHC3, GRM1, HSPA8	182	99	6879	3.0542790542790548	0.9673620420293375	0.4346893554149077	17.72014993982144
KEGG_PATHWAY	hsa05100:Bacterial invasion of epithelial cells	7	1.3888888888888888	0.01640351199278537	ARHGEF26, GAB1, SHC3, CLTCL1, CTNNA3, CTNNA2, ELMO1	182	78	6879	3.392011834319527	0.9753962591360783	0.410962396421404	19.034634905614855
KEGG_PATHWAY	hsa04723:Retrograde endocannabinoid signaling	8	1.5873015873015872	0.016771772517084036	ADCY2, KCNJ6, GABRB3, ADCY9, PRKCG, MAPK10, GRM1, CACNA1B	182	101	6879	2.993798280926994	0.9773758766924169	0.3772389103012044	19.420776103199533
KEGG_PATHWAY	hsa04728:Dopaminergic synapse	9	1.7857142857142856	0.019293437469790037	KCNJ6, CAMK2G, KIF5C, ATF6B, PRKCG, MAPK10, PPP2R2C, PPP2R2A, CACNA1B	182	128	6879	2.6575807005494507	0.987272173552954	0.3842319682313815	22.01961444882292
KEGG_PATHWAY	hsa04144:Endocytosis	13	2.579365079365079	0.024813933275234866	RAB7A, ARFGAP3, KIF5C, PSD3, RAB11FIP5, AP2B1, WIPF2, PDCD6IP, NEDD4L, CLTCL1, HSPA8, ARAP1, AP2M1	182	241	6879	2.0388263189093063	0.996405841641247	0.4304134561152373	27.44161703573994
KEGG_PATHWAY	hsa04261:Adrenergic signaling in cardiomyocytes	9	1.7857142857142856	0.028751765867603175	RPS6KA5, ADCY2, ADCY9, CAMK2G, ATF6B, ATP1A3, CACNB2, PPP2R2C, PPP2R2A	182	138	6879	2.4650023889154324	0.9985479744681158	0.44792553615139197	31.094470420416307
KEGG_PATHWAY	hsa04310:Wnt signaling pathway	9	1.7857142857142856	0.028751765867603175	CHD8, CSNK2A1, BTRC, CAMK2G, LRP6, LEF1, PRKCG, MAPK10, RBX1	182	138	6879	2.4650023889154324	0.9985479744681158	0.44792553615139197	31.094470420416307
KEGG_PATHWAY	hsa04724:Glutamatergic synapse	8	1.5873015873015872	0.030272428049298993	ADCY2, ADCY9, GRIK1, GRIK2, GRIK4, PRKCG, GRIN3A, GRM1	182	114	6879	2.6524002313476	0.9989777840746686	0.43662804957012	32.45913316872849
KEGG_PATHWAY	hsa04340:Hedgehog signaling pathway	4	0.7936507936507936	0.03297287102926383	BTRC, PTCH1, HHIP, GLI3	182	27	6879	5.5995115995116	0.999452657236921	0.4388268604804727	34.82132262200695
KEGG_PATHWAY	hsa04918:Thyroid hormone synthesis	6	1.1904761904761905	0.03651269160273091	GSR, ADCY2, ADCY9, ATF6B, ATP1A3, PRKCG	182	70	6879	3.2397174254317114	0.999759284747653	0.44851212043900646	37.8024650999936
KEGG_PATHWAY	hsa04930:Type II diabetes mellitus	5	0.992063492063492	0.036727907019762446	HK1, CACNA1E, MAPK10, INSR, CACNA1B	182	48	6879	3.937156593406593	0.9997710339021808	0.42810265699984007	37.979596254425005
KEGG_PATHWAY	hsa04913:Ovarian steroidogenesis	5	0.992063492063492	0.039199900719651105	CYP2J2, ADCY2, ADCY9, SCARB1, INSR	182	49	6879	3.856806458847275	0.9998712341210456	0.4287022024398337	39.981080244704756
KEGG_PATHWAY	hsa04066:HIF-1 signaling pathway	7	1.3888888888888888	0.04036335542540474	FLT1, CAMK2G, TEK, HK1, PRKCG, INSR, RBX1	182	96	6879	2.7560096153846154	0.9999018413738955	0.41892647758849155	40.902331618241625"
kegg=read.delim(text = txt, stringsAsFactors = F) %>% arrange(-PValue)
kegg$Term <- sub("hsa\\d+:(.*)","\\1",kegg$Term)
kegg$Term <- factor(kegg$Term, as.character(kegg$Term))

pdf("../results/Merge_circexplorer_BC.cellspecific_heatmap5.genes3.SNDA.KEGG.pdf", width=9, height=nrow(kegg)/5)
p = ggplot(kegg, aes(x = Term, y = -log10(PValue))) + 
  geom_bar(stat = "identity") + 
  coord_flip() + 
  theme_bw() + theme_classic() +
  xlab("KEGG pathway") + ylab("-log10(EASE p value)") 
print(p)
dev.off() 

txt="Category	Term	Count	%	PValue	Genes	List Total	Pop Hits	Pop Total	Fold Enrichment	Bonferroni	Benjamini	FDR
KEGG_PATHWAY	hsa04724:Glutamatergic synapse	11	2.9729729729729732	5.64570739802734E-5	GLS2, GRM5, ADCY1, DLGAP1, GRM3, GNAO1, GRM8, GRIN1, GRIN2A, PRKACB, CACNA1A	132	114	6879	5.028508771929824	0.011395681234243615	0.011395681234243615	0.07091243871435449
KEGG_PATHWAY	hsa04727:GABAergic synapse	9	2.4324324324324325	1.962765869391299E-4	GLS2, ADCY1, GABRG3, GNAO1, TRAK2, GABRA4, GABRB2, PRKACB, CACNA1A	132	85	6879	5.517914438502673	0.03906456538858294	0.019726857140614507	0.24633237456836987
KEGG_PATHWAY	hsa04723:Retrograde endocannabinoid signaling	9	2.4324324324324325	6.390785063163251E-4	GRM5, ADCY1, GABRG3, GNAO1, GABRA4, GABRB2, MAPK9, PRKACB, CACNA1A	132	101	6879	4.6437893789378935	0.12170645649942813	0.04233584982438343	0.8000107593896133
KEGG_PATHWAY	hsa05033:Nicotine addiction	6	1.6216216216216217	8.941913852676818E-4	GABRG3, GABRA4, GABRB2, GRIN1, GRIN2A, CACNA1A	132	40	6879	7.817045454545456	0.16606686759699552	0.044385332070218	1.1177175697051678
KEGG_PATHWAY	hsa04720:Long-term potentiation	7	1.891891891891892	0.0015159882074382769	GRM5, ADCY1, CAMK4, GRIN1, GRIN2A, RAF1, PRKACB	132	66	6879	5.527203856749311	0.26506933054385495	0.05973715672358382	1.8881580262935516
KEGG_PATHWAY	hsa05032:Morphine addiction	8	2.1621621621621623	0.001659522515263193	ADCY1, GABRG3, GNAO1, GABRA4, GABRB2, ARRB1, PRKACB, CACNA1A	132	91	6879	4.581418581418581	0.2862074554867622	0.05464410960590338	2.0652182059219926
KEGG_PATHWAY	hsa04020:Calcium signaling pathway	11	2.9729729729729732	0.0021025770748828157	ATP2B1, GRM5, GNA14, ADCY1, CAMK4, GRIN1, PDGFRA, HTR4, GRIN2A, PRKACB, CACNA1A	132	179	6879	3.202513966480447	0.3477142136360851	0.05921338313187474	2.609905416925007
KEGG_PATHWAY	hsa04024:cAMP signaling pathway	11	2.9729729729729732	0.004360499218209016	ATP2B1, ADCY1, CAMK4, TIAM1, GRIN1, HTR4, CREB3L2, GRIN2A, RAF1, MAPK9, PRKACB	132	198	6879	2.8952020202020203	0.588158571601695	0.10496245402837834	5.342717404914088
KEGG_PATHWAY	hsa04540:Gap junction	7	1.891891891891892	0.006438557039101843	GRM5, ADCY1, PDGFRA, RAF1, PRKG2, PRKACB, LPAR1	132	88	6879	4.145402892561983	0.7305177926418227	0.13557848794759375	7.79528508698204
KEGG_PATHWAY	hsa05030:Cocaine addiction	5	1.3513513513513513	0.013736623466359347	GRM3, GRIN1, CREB3L2, GRIN2A, PRKACB	132	49	6879	5.317717996289425	0.9396662909722703	0.24481039660948256	15.95269984121389
KEGG_PATHWAY	hsa04080:Neuroactive ligand-receptor interaction	12	3.2432432432432434	0.016212477344186474	GRM5, GABRG3, GRM3, RXFP1, GABRA4, GRM8, GABRB2, GRIN1, HTR4, GRIN2A, CALCRL, LPAR1	132	277	6879	2.257630456186413	0.9637785398477117	0.26039999594918617	18.565509276080615
KEGG_PATHWAY	hsa04015:Rap1 signaling pathway	10	2.7027027027027026	0.01845904486929561	ADCY1, GNAO1, TIAM1, GRIN1, PDGFRA, GRIN2A, RAF1, LPAR1, DOCK4, FARP2	132	210	6879	2.4816017316017316	0.9772275185985022	0.2703450557309799	20.87143915471653
KEGG_PATHWAY	hsa04725:Cholinergic synapse	7	1.891891891891892	0.01890973086551148	KCNQ5, ADCY1, GNAO1, CAMK4, CREB3L2, PRKACB, CACNA1A	132	111	6879	3.286445536445537	0.9792546604038203	0.25778051760418785	21.32673324840424
KEGG_PATHWAY	hsa05230:Central carbon metabolism in cancer	5	1.3513513513513513	0.03316816758967316	GLS2, PDGFRA, RAF1, MTOR, PTEN	132	64	6879	4.071377840909091	0.9989377151234551	0.38681906580053016	34.54517950210243
KEGG_PATHWAY	hsa04713:Circadian entrainment	6	1.6216216216216217	0.034445796451056956	ADCY1, GNAO1, GRIN1, GRIN2A, PRKG2, PRKACB	132	95	6879	3.291387559808612	0.9991878022997882	0.3777320253544443	35.623692915696324
KEGG_PATHWAY	hsa04728:Dopaminergic synapse	7	1.891891891891892	0.034970716759053166	GNAO1, CREB3L2, GRIN2A, MAPK9, PRKACB, PPP2R2D, CACNA1A	132	128	6879	2.8499644886363638	0.9992726894851702	0.36341340137964095	36.06204579381457
KEGG_PATHWAY	hsa05031:Amphetamine addiction	5	1.3513513513513513	0.0365578442400563	CAMK4, GRIN1, CREB3L2, GRIN2A, PRKACB	132	66	6879	3.9480027548209367	0.9994792779640422	0.35899831091651113	37.37077604785078
KEGG_PATHWAY	hsa04916:Melanogenesis	6	1.6216216216216217	0.041561531015856724	DCT, ADCY1, GNAO1, CREB3L2, RAF1, PRKACB	132	100	6879	3.126818181818182	0.999819057720442	0.38043687911628066	41.33710052325436
KEGG_PATHWAY	hsa04141:Protein processing in endoplasmic reticulum	8	2.1621621621621623	0.04200364107431749	NGLY1, RAD23B, TUSC3, HSPA4L, MAPK9, SKP1, MARCH6, SEC24D	132	169	6879	2.4669176976869287	0.9998352356438934	0.3677518892411684	41.676192468752035
KEGG_PATHWAY	hsa04976:Bile secretion	5	1.3513513513513513	0.042004583973712116	ADCY1, NCEH1, LDLR, PRKACB, ABCG2	132	69	6879	3.7763504611330703	0.999835268560695	0.3530975072320862	41.67691372687984
"

kegg=read.delim(text = txt, stringsAsFactors = F) %>% arrange(-PValue)
kegg$Term <- sub("hsa\\d+:(.*)","\\1",kegg$Term)
kegg$Term <- factor(kegg$Term, as.character(kegg$Term))

pdf("../results/Merge_circexplorer_BC.cellspecific_heatmap5.genes3.PY.KEGG.pdf", width=9, height=nrow(kegg)/5)
p = ggplot(kegg, aes(x = Term, y = -log10(PValue))) + 
  geom_bar(stat = "identity") + 
  coord_flip() + 
  theme_bw() + theme_classic() +
  xlab("KEGG pathway") + ylab("-log10(EASE p value)") 
print(p)
dev.off() 

txt="Category	Term	Count	%	PValue	Genes	List Total	Pop Hits	Pop Total	Fold Enrichment	Bonferroni	Benjamini	FDR
KEGG_PATHWAY	hsa04120:Ubiquitin mediated proteolysis	24	2.013422818791946	1.999388290751245E-5	ANAPC1, UBE2Z, UBE3B, DDB1, ANAPC4, UBE2F, SAE1, UBE2C, MID1, UBE2R2, FANCL, CBLB, FBXW7, CUL5, FBXW8, UBE2D2, CUL4A, UBE2K, MAP3K1, MDM2, FBXO4, PIAS1, ANAPC7, CUL1	447	137	6879	2.6959290648116396	0.004886571952388397	0.004886571952388397	0.025888307136945343
KEGG_PATHWAY	hsa04710:Circadian rhythm	9	0.7550335570469799	6.132477247086505E-4	CRY2, CREB1, PRKAB1, PRKAA1, BHLHE40, RORA, PER3, FBXL3, CUL1	447	31	6879	4.467850184022515	0.13954312458126727	0.0723918524405186	0.7912317454761841
KEGG_PATHWAY	hsa04110:Cell cycle	19	1.5939597315436242	9.816135383885326E-4	ANAPC1, CDC14A, DBF4, ANAPC4, RBL1, SMAD4, PRKDC, SMAD2, ATR, MCM3, YWHAE, ATM, CCNB1, MDM2, BUB1B, ANAPC7, ORC2, CUL1, STAG2	447	124	6879	2.358032041567439	0.21385453282567402	0.07707239035798463	1.263727569408779
KEGG_PATHWAY	hsa05130:Pathogenic Escherichia coli infection	11	0.9228187919463088	0.001363473251467702	ARPC1A, CDC42, NCK2, TUBA8, ROCK1, FYN, ROCK2, HCLS1, TLR5, ITGB1, CTNNB1	447	51	6879	3.3192525332280565	0.2841458891606605	0.08017304787577328	1.7513390143389262
KEGG_PATHWAY	hsa04144:Endocytosis	29	2.4328859060402683	0.0017595958540909907	USP8, SNX6, CYTH1, SNX5, CHMP4A, CAPZA1, ASAP2, SNX1, PIP5K1A, CDC42, IGF1R, DAB2, KIAA1033, SPG21, STAM, FAM21C, TGFBR2, SMAD2, HLA-E, ARPC1A, CBLB, RAB11FIP3, IGF2R, IST1, RAB5A, MDM2, RAB10, RAB11FIP1, DNM2	447	241	6879	1.8518198780250075	0.3504534088125151	0.08267746701592005	2.2548143489506844
KEGG_PATHWAY	hsa04520:Adherens junction	13	1.0906040268456376	0.0018280028806322531	PTPRJ, ERBB2, MET, TGFBR2, SMAD4, SMAD2, TCF7L2, CTNNB1, CDC42, IGF1R, MAPK1, FYN, YES1	447	71	6879	2.8177521504868133	0.36126814864941137	0.07198906089589019	2.3415188260386355
KEGG_PATHWAY	hsa05205:Proteoglycans in cancer	24	2.013422818791946	0.004998955668653182	ROCK1, ROCK2, HCLS1, ERBB2, MET, RPS6KB1, PDCD4, ITGB1, CTNNB1, PTPN11, CDC42, IGF1R, MAPK1, PDPK1, CBLB, HIF1A, CD44, PLCG2, SOS2, PPP1R12A, CAMK2D, MDM2, THBS1, FN1	447	200	6879	1.8467114093959731	0.707068240548993	0.16088056492982516	6.28361298996305
KEGG_PATHWAY	hsa04068:FoxO signaling pathway	18	1.5100671140939599	0.005683788394581946	USP7, SGK1, TGFBR2, SMAD4, PRKAB1, BNIP3, FOXO1, SMAD2, STK4, ATM, CCNB1, IGF1R, MAPK1, PDPK1, SOS2, MDM2, PRKAA1, EGF	447	134	6879	2.0672142642492233	0.7525385914031621	0.1601757029890878	7.115472053941996
KEGG_PATHWAY	hsa03022:Basal transcription factors	9	0.7550335570469799	0.0075427170393805735	TAF2, GTF2E1, TAF1, TAF12, GTF2A1, TAF5, GTF2B, GTF2H2, ERCC2	447	45	6879	3.077852348993288	0.8435424044038107	0.1862546556529191	9.339267314685829
KEGG_PATHWAY	hsa03013:RNA transport	21	1.761744966442953	0.007587335854862915	NCBP1, NUP133, NUP153, RGPD8, EIF5, NUP155, SMN2, SMN1, EIF4G2, NUP214, UPF3B, EIF3B, EIF3H, EIF3E, NUP50, CYFIP2, NUP107, PABPC1, TPR, THOC2, TGS1	447	172	6879	1.878921492117996	0.8452563184758807	0.17022319155969867	9.392034893973623
KEGG_PATHWAY	hsa04070:Phosphatidylinositol signaling system	14	1.174496644295302	0.010241552728108595	PIK3C2A, PIP5K1A, PI4KB, PI4K2B, TMEM55A, MTM1, MTMR1, DGKE, DGKD, DGKG, PLCG2, PIP4K2A, PIP4K2B, IP6K2	447	98	6879	2.198465963566635	0.9197106085653977	0.20489685801765212	12.480490036020742
KEGG_PATHWAY	hsa03018:RNA degradation	12	1.006711409395973	0.010287553401714264	EXOSC10, PATL1, CNOT8, CNOT6L, DCP2, DCP1A, CNOT3, DHX36, CNOT1, PABPC1, CNOT6, HSPA9	447	77	6879	2.398326505709056	0.9206196820643899	0.19032747420131169	12.533149646721842
KEGG_PATHWAY	hsa04114:Oocyte meiosis	15	1.2583892617449663	0.012103119039741617	PPP2R1B, ANAPC1, PPP2R5C, ANAPC4, AURKA, YWHAE, CCNB1, MAPK1, IGF1R, SLK, CAMK2D, PPP3CB, PPP3CA, ANAPC7, CUL1	447	111	6879	2.079629965536006	0.949377278089741	0.205060149724416	14.588332806137682
KEGG_PATHWAY	hsa05200:Pathways in cancer	38	3.1879194630872485	0.012956513253588481	ERBB2, FOXO1, ITGB1, TCF7L2, TPM3, ARNT, CTNNB1, IGF1R, CDC42, RASGRP1, SOS2, TPR, RUNX1, EGF, LAMB1, CSF2RA, AXIN1, FN1, ROCK1, MSH2, FLT3, RALBP1, ROCK2, MET, TGFBR2, SMAD4, SMAD2, STK4, MAPK1, VEGFC, CBLB, HIF1A, GNAQ, GNB1, ETS1, PLCG2, MDM2, GNB4	447	393	6879	1.488020219615076	0.9590371346053286	0.20405139951988338	15.538879386080673
KEGG_PATHWAY	hsa04360:Axon guidance	16	1.342281879194631	0.01693564254322581	ROCK1, ROCK2, MET, NTNG1, ITGB1, CDC42, MAPK1, NCK2, FYN, PPP3CB, SEMA4B, SEMA3C, PPP3CA, NFATC2, RASA1, SRGAP1	447	127	6879	1.9388046292871108	0.9847742800366913	0.2434484549722855	19.843494701275265
KEGG_PATHWAY	hsa04666:Fc gamma R-mediated phagocytosis	12	1.006711409395973	0.019073306293196472	ARPC1A, CDC42, MAPK1, PTPRC, MYO10, VAV3, GAB2, LYN, PLCG2, ASAP2, RPS6KB1, PIP5K1A	447	84	6879	2.1984659635666346	0.991067860552125	0.2553799631150948	22.07152098631042
KEGG_PATHWAY	hsa04611:Platelet activation	16	1.342281879194631	0.020564480506745177	ROCK1, LYN, ROCK2, PRKG1, APBB1IP, ITGB1, MAPK1, GNAQ, FYN, RASGRP1, PLCG2, PPP1R12A, GUCY1A3, GUCY1B3, COL1A1, SNAP23	447	130	6879	1.89406298399587	0.9938470527094566	0.25878180724157085	23.591738779425995
KEGG_PATHWAY	hsa04141:Protein processing in endoplasmic reticulum	19	1.5939597315436242	0.025083865916147495	MBTPS2, SEC24A, PDIA3, SEC63, STT3B, ATXN3, EIF2AK1, UBE2D2, STT3A, DNAJA1, ERN1, DNAJC5, NFE2L2, DNAJC3, UGGT1, TRAM1, CUL1, DNAJC1, SEC23B	447	169	6879	1.7301536873039198	0.9980185727527369	0.29232782746683994	28.03360789417555
KEGG_PATHWAY	hsa04922:Glucagon signaling pathway	13	1.0906040268456376	0.02570796113304237	CREB1, PRKAB1, PDE3B, FOXO1, CREB5, CPT1A, PDHB, PKM, GNAQ, CAMK2D, PPP3CB, PRKAA1, PPP3CA	447	99	6879	2.0208121483289267	0.9983062757904018	0.2852574857423088	28.627915555894024
KEGG_PATHWAY	hsa05215:Prostate cancer	12	1.006711409395973	0.02609929661045482	MAPK1, IGF1R, PDPK1, CREB1, ERBB2, SOS2, MDM2, FOXO1, CREB5, EGF, TCF7L2, CTNNB1	447	88	6879	2.098535692495424	0.9984650420691525	0.27672271858279895	28.998259177096376
KEGG_PATHWAY	hsa04022:cGMP-PKG signaling pathway	18	1.5100671140939599	0.02655432926537824	SLC8A3, MEF2A, ROCK1, ROCK2, CREB1, PDE3B, PDE3A, CREB5, PRKG1, MAPK1, GNAQ, PDE5A, PPP1R12A, PPP3CB, GUCY1A3, GUCY1B3, PPP3CA, NFATC2	447	158	6879	1.7532070342366832	0.9986311025686646	0.26947226322989726	29.426653067320263
KEGG_PATHWAY	hsa04152:AMPK signaling pathway	15	1.2583892617449663	0.027476835164073093	PPP2R1B, IGF1R, PDPK1, CD36, PFKFB4, CREB1, PPP2R5C, PRKAB1, FOXO1, CREB5, PRKAA1, RPS6KB1, RAB10, RPTOR, CPT1A	447	123	6879	1.8767392371910294	0.9989148521708198	0.26675434910741236	30.287843174220242
KEGG_PATHWAY	hsa04660:T cell receptor signaling pathway	13	1.0906040268456376	0.0275701147681274	PTPRC, VAV3, NFKBIE, CDC42, MAPK1, NCK2, PDPK1, FYN, RASGRP1, SOS2, PPP3CB, PPP3CA, NFATC2	447	100	6879	2.0006040268456373	0.998940056173864	0.2575546839328745	30.37438076078205
KEGG_PATHWAY	hsa03420:Nucleotide excision repair	8	0.6711409395973155	0.030332067016129872	XPA, ERCC6, POLE2, RFC1, CUL4A, DDB1, GTF2H2, ERCC2	447	47	6879	2.6194488076538627	0.9994719886563169	0.269797242150669	32.892227198776695
KEGG_PATHWAY	hsa04810:Regulation of actin cytoskeleton	22	1.8456375838926176	0.03062381722494732	ITGAL, VAV3, ROCK1, ROCK2, DIAPH2, ARHGEF6, DIAPH3, ITGA11, IQGAP2, PIP5K1A, ITGB1, NCKAP1, ARPC1A, CDC42, MAPK1, SOS2, CYFIP2, PPP1R12A, PIP4K2A, EGF, FN1, PIP4K2B	447	210	6879	1.6122083732821988	0.9995095163451669	0.26273268388278503	33.15322616451268
KEGG_PATHWAY	hsa05203:Viral carcinogenesis	21	1.761744966442953	0.04282466324261256	USP7, SP100, LYN, IL6ST, CREB1, DDB1, RBL1, CREB5, HLA-E, GTF2B, YWHAE, GTF2H2, PKM, CDC42, GTF2E1, MAPK1, REL, GTF2A1, SND1, MDM2, RASA2	447	205	6879	1.576460959240465	0.99997797492279	0.3379642531077439	43.26561230785367
KEGG_PATHWAY	hsa04510:Focal adhesion	21	1.761744966442953	0.044694798386530565	VAV3, ROCK1, ROCK2, ERBB2, MET, ITGA11, ITGB1, CTNNB1, CDC42, IGF1R, VEGFC, MAPK1, PDPK1, FYN, SOS2, PPP1R12A, COL1A1, THBS1, LAMB1, EGF, FN1	447	206	6879	1.5688082361373559	0.9999863596690871	0.33959807598523695	44.68441833195712
KEGG_PATHWAY	hsa03450:Non-homologous end-joining	4	0.33557046979865773	0.047567724069199485	XRCC5, XRCC4, XRCC6, PRKDC	447	13	6879	4.735157459989675	0.999993478379005	0.3471725418327013	46.80034288247007
KEGG_PATHWAY	hsa05213:Endometrial cancer	8	0.6711409395973155	0.04903164430683975	MAPK1, PDPK1, ERBB2, SOS2, EGF, TCF7L2, AXIN1, CTNNB1	447	52	6879	2.3675787299948374	0.9999955261019459	0.3460554880397838	47.849562135395075"

kegg=read.delim(text = txt, stringsAsFactors = F) %>% arrange(-PValue)
kegg$Term <- sub("hsa\\d+:(.*)","\\1",kegg$Term)
kegg$Term <- factor(kegg$Term, as.character(kegg$Term))

pdf("../results/Merge_circexplorer_BC.cellspecific_heatmap5.genes3.NN.KEGG.pdf", width=9, height=nrow(kegg)/5)
p = ggplot(kegg, aes(x = Term, y = -log10(PValue))) + 
  geom_bar(stat = "identity") + 
  coord_flip() + 
  theme_bw() + theme_classic() +
  xlab("KEGG pathway") + ylab("-log10(EASE p value)") 
print(p)
dev.off() 